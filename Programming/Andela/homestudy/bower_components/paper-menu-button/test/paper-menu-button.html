<!DOCTYPE html><html><head><meta charset="UTF-8"><title>paper-menu-button basic tests</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script src="../../webcomponentsjs/webcomponents-lite.js"></script><script src="../../web-component-tester/browser.js"></script><script src="../../iron-test-helpers/mock-interactions.js"></script><link rel="import" href="../paper-menu-button.html"></head><body><test-fixture id="TrivialMenuButton"><template><paper-menu-button no-animations=""><span slot="dropdown-trigger">trigger</span> <span slot="dropdown-content">content</span></paper-menu-button></template></test-fixture><test-fixture id="TwoMenuButtons"><template><paper-menu-button no-animations=""><span slot="dropdown-trigger">trigger</span> <span slot="dropdown-content">content</span></paper-menu-button><paper-menu-button no-animations=""><span slot="dropdown-trigger">trigger</span> <span slot="dropdown-content">content</span></paper-menu-button></template></test-fixture><script>suite("<paper-menu-button>",function(){var menuButton,trigger,content;setup(function(){menuButton=fixture("TrivialMenuButton");trigger=Polymer.dom(menuButton).querySelector("[slot=\"dropdown-trigger\"]");content=Polymer.dom(menuButton).querySelector("[slot=\"dropdown-content\"]")});test("opens when trigger is clicked",function(done){var contentRect=content.getBoundingClientRect();expect(contentRect.width).to.be.equal(0);expect(contentRect.height).to.be.equal(0);menuButton.addEventListener("paper-dropdown-open",function(){expect(menuButton.opened).to.be.equal(!0);done()});MockInteractions.tap(trigger)});test("closes when trigger is clicked again",function(done){menuButton.addEventListener("paper-dropdown-open",function(){menuButton.addEventListener("paper-dropdown-close",function(){expect(menuButton.opened).to.be.equal(!1);done()});Polymer.Base.async(function(){MockInteractions.tap(trigger)})});MockInteractions.tap(trigger)});test("closes when disabled while open",function(){var contentRect;menuButton.opened=!0;menuButton.disabled=!0;expect(menuButton.opened).to.be.equal(!1);contentRect=content.getBoundingClientRect();expect(contentRect.width).to.be.equal(0);expect(contentRect.height).to.be.equal(0)});test("has aria-haspopup attribute",function(){expect(menuButton.hasAttribute("aria-haspopup")).to.be.equal(!0)});test("closes on iron-activate if close-on-activate is true",function(done){menuButton.closeOnActivate=!0;menuButton.addEventListener("paper-dropdown-open",function(){menuButton.addEventListener("paper-dropdown-close",function(){done()});content.dispatchEvent(new CustomEvent("iron-activate",{bubbles:!0,cancelable:!0}))});MockInteractions.tap(trigger)});test("allowOutsideScroll propagates to <iron-dropdown>",function(){menuButton.allowOutsideScroll=!1;expect(menuButton.$.dropdown.allowOutsideScroll).to.be.equal(!1);menuButton.allowOutsideScroll=!0;expect(menuButton.$.dropdown.allowOutsideScroll).to.be.equal(!0)});test("restoreFocusOnClose propagates to <iron-dropdown>",function(){menuButton.restoreFocusOnClose=!1;expect(menuButton.$.dropdown.restoreFocusOnClose).to.be.equal(!1);menuButton.restoreFocusOnClose=!0;expect(menuButton.$.dropdown.restoreFocusOnClose).to.be.equal(!0)})});suite("when there are two buttons",function(){var menuButton,trigger,otherButton,otherTrigger;setup(function(){var buttons=fixture("TwoMenuButtons");menuButton=buttons[0];otherButton=buttons[1];trigger=Polymer.dom(menuButton).querySelector("[slot=\"dropdown-trigger\"]");otherTrigger=Polymer.dom(otherButton).querySelector("[slot=\"dropdown-trigger\"]")});test("closes current and opens other",function(done){expect(menuButton.opened).to.be.equal(!1);expect(otherButton.opened).to.be.equal(!1);menuButton.addEventListener("iron-overlay-opened",function(){expect(menuButton.opened).to.be.equal(!0);expect(otherButton.opened).to.be.equal(!1);var firstClosed=!1,secondOpened=!1;menuButton.addEventListener("paper-dropdown-close",function(){firstClosed=!0});otherButton.addEventListener("paper-dropdown-open",function(){secondOpened=!0});Polymer.Base.async(function(){MockInteractions.tap(otherTrigger)});Polymer.Base.async(function(){expect(firstClosed).to.be.equal(!0);expect(secondOpened).to.be.equal(!0);done()})});MockInteractions.tap(trigger)})});</script></body></html>